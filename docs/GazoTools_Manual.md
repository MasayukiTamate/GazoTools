# GazoTools 取扱説明書 (マニュアル)

**最終更新日**: 2026年01月01日
**バージョン**: 2.7.0 (タグ付け機能・パズルレイアウト・没入・高速・多段仕分け特化型)

---

## 1. はじめに
GazoToolsは、大量の画像を効率的に「閲覧」「整理」「仕分け」するために開発された、超軽量かつ直感的な画像ビューアーアプリなのじゃ。ドラッグ＆ドロップ（D&D）をフル活用した操作性と、画面を広く使うための没入型デザインが特徴なのじゃ。

---

## 2. 基本機能

### フォルダ・ファイル選択
- **メイン窓**: 起動すると、最後に開いていたフォルダを自動的に読み込むのじゃ。
- **子データ窓（フォルダ一覧）**: 現在のフォルダ内のサブフォルダを一覧表示するのじゃ。クリックで移動、右クリックで「クイック仕分け」の宛先登録ができるのじゃ。
- **子データ窓（ファイル一覧）**: 画像ファイルを一覧表示するのじゃ。クリックで表示、ダブルクリックで専用窓が開くのじゃ。

### 画像の表示
- 画像をクリックまたはダブルクリックすると、別ウィンドウで画像が表示されるのじゃ。
- **スペースキー**: 開いている画像をランダムな別の画像に切り替えるのじゃ。

---

## 3. クイック仕分け機能 (D&D移動)

このアプリの目玉機能なのじゃ！最大12箇所のフォルダを「仕分け先」として登録し、画像を投げ込むだけで移動が完了するのじゃ。

### 仕分け先の登録 (上段エリア / 右クリック)
- **直接登録**: フォルダ一覧で任意のフォルダを右クリックし、スロット（1〜12）を選べば登録完了なのじゃ。
- **登録を挿入**: 右クリックメニューの一番上にある「登録を挿入」を選ぶと、現在の空き枠に順番に登録していくのじゃ。
- **一括リセット**: メイン窓最下部のボタン、または「設定」メニューから、全ての登録を消去してやり直せるのじゃ。

### 仕分けの実行 (下段エリア)
- 表示されている画像を、メイン窓の中段〜下段に並んでいる仕分け先ラベルにドラッグ＆ドロップするのじゃ。
- 放り投げた瞬間、画像ファイルがそのフォルダへ移動し、次の画像が自動的に表示されるのじゃ（自動再生時）。

---

## 4. パズルタイル表示 (Ctrl + T)

開いている全ての画像を、まるでジグゾーパズルのように隙間なく画面いっぱいに敷き詰める魔法の機能なのじゃ！

- **操作**: `Ctrl + T` を押すのじゃ。
- **再帰的分割アルゴリズム**: 画像の枚数に合わせて画面を黄金比に近い形で分割し、完全に隙間なく配置するのじゃ。
- **ピクセル・パーフェクト**: どんな枚数でも画面全体をピタリと埋め尽くすように計算されているのじゃ。
- **動的ワークエリア回避**: タスクバーの位置やサイズを自動で読み取って、邪魔にならない領域にだけ美しく並べるのじゃ。
- **枠なし没入**: タイトルバーを消して、画像だけがカタログのように並ぶのじゃ（没入モード）。
- **ドラッグ移動**: 枠がなくても大丈夫！画像の上を左ドラッグすれば、自由に窓を動かせるのじゃ。

---

## 5. ショートカットキー一覧

| キー | 機能 | 対象 |
| :--- | :--- | :--- |
| **Space** | 次の画像をランダムに表示 | 画像窓 |
| **Ctrl + R** | 全ての画像ウィンドウを閉じる | 全体 |
| **Ctrl + T** | 全ての画像をパズル状に整列 (枠なし) | 全体 |
| **Ctrl + E** | 現在のフォルダをエクスプローラーで開く | メイン窓 |
| **Ctrl + F** | メインウィンドウを強制的に最前面へ | 全体 |
| **Escape** | スクリーンセーバー(自動再生)を停止 | 全体 |

---

## 6. 高度な設定

### スクリーンセーバー（自動再生）
「設定」メニューからオンにすると、1秒〜30秒間隔で画像を次々と表示するのじゃ。

#### **New! AI類似度再生モード**
- AI（人工知能）を使って、似ている画像を連続して再生する機能が追加されたのじゃ！
- **設定手順**:
    1. 「設定」→「SS設定」メニューを開く。
    2. **「AI類似度順で再生」** にチェックを入れる。
    3. 必要に応じて「類似度の閾値を設定...」から感度（0.0〜1.0）を変更するのじゃ。
- これを有効にすると、まず1枚目の画像を表示し、次にその画像と似ている（閾値以上の）画像を優先的に表示するプレイリストが自動生成されるのじゃ。
- 似た画像が尽きると、まだ表示していない新しい画像を選んで、またそれと似ている画像を探す…という賢い動きをするのじゃ。

### メモリ最適化（プロ仕様）
リソースを徹底的に「お掃除」するロジックにより、大量の画像を表示し続けても快適な動作を維持するのじゃ。


---

## 7. 困ったときは (Q&A)

**Q. 画像が動かせなくなった！**
A. 画像の上を左クリックして、そのままマウスを動かしてみてほしいのじゃ。タイトルバーの有無に関係なく動かせるはずなのじゃ！

**Q. 全部やり直したい！**
A. 「全登録フォルダをリセット」を押せば、スッキリ最初から設定し直せるのじゃ。

---

## 8. 画像タグ付け機能 (Ver 2.7.0 New!)

お気に入りの画像に「タグ」をつけて管理できるようになったのじゃ！

- **タグの表示**: 画像ウィンドウの左上に、設定されたタグがラベルとして表示されるのじゃ。
- **タグの編集**: 画像の上で **右クリック** するとメニューが出るので、「タグを編集」を選ぶのじゃ。
- **保存の仕組み**: タグデータは `data/tagdata.csv` というファイルに記録されるのじゃ。
    - 画像の内容（ハッシュ値）をキーにしているので、**ファイル名を変更しても、別のフォルダに移動しても、タグはちゃんとついてくるのじゃ！** すごいのじゃ！

---

**開発者からのメッセージ**
「ポンコツでした」と言われないよう、最新の Windows API を活用して精緻に作り上げたのじゃ。最高の画像ライフを楽しんでほしいのじゃ！のじゃ。
